!function(){"use strict";var e="";const t={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__submit-btn",inactiveButtonClass:"modal__submit-btn_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},r=(e,t,r)=>{e.querySelector(`#${t.id}-error`).textContent="",t.classList.remove(r.inputErrorClass)},n=(e,t,r)=>{(e=>e.some((e=>!e.validity.valid)))(e)?o(t,r):(t.disabled=!1,t.classList.remove(r.inactiveButtonClass))},o=(e,t)=>{e.disabled=!0,e.classList.add(t.inactiveButtonClass)},a=e=>{document.querySelectorAll(e.formSelector).forEach((t=>{((e,t)=>{const o=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n(o,a,t),o.forEach((s=>{s.addEventListener("input",(function(){((e,t,n)=>{t.validity.valid?r(e,t,n):((e,t,r,n)=>{e.querySelector(`#${t.id}-error`).textContent=r,t.classList.add(n.inputErrorClass)})(e,t,t.validationMessage,n)})(e,s,t),n(o,a,t)}))}))})(t,e)}))};a(t);function s(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"Save",n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Saving...";e.textContent=t?n:r}var c=e+"d3610e9c6dce3cb370d8.svg";document.getElementById("header__logo").src=c;const l=document.getElementById("profile__avatar");let i,d;const u=new class{constructor(e){let{baseUrl:t,headers:r}=e;this._baseUrl=t,this._headers=r,this._checkResponse=e=>{if(e.ok)return e.json();Promise.reject(`Error: ${e.status}`)}}getAppInfo(){return Promise.all([this.getInitialCards(),this.getUserInfo()])}getInitialCards(){return fetch(`${this._baseUrl}/cards`,{headers:this._headers}).then((e=>this._checkResponse(e)))}getUserInfo(){return fetch(`${this._baseUrl}/users/me`,{headers:this._headers}).then((e=>this._checkResponse(e)))}editUserInfo(e){let{name:t,about:r}=e;return fetch(`${this._baseUrl}/users/me`,{method:"PATCH",headers:this._headers,body:JSON.stringify({name:t,about:r})}).then((e=>this._checkResponse(e)))}editAvatarInfo(e){return fetch(`${this._baseUrl}/users/me/avatar`,{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((e=>this._checkResponse(e)))}addCard(e){let{name:t,link:r}=e;return fetch(`${this._baseUrl}/cards`,{method:"POST",headers:this._headers,body:JSON.stringify({name:t,link:r})}).then((e=>this._checkResponse(e)))}deleteCard(e){return fetch(`${this._baseUrl}/cards/${e}`,{method:"DELETE",headers:this._headers}).then((e=>this._checkResponse(e)))}toggleLike(e,t){const r=t?"DELETE":"PUT";return fetch(`${this._baseUrl}/cards/${e}/likes`,{method:r,headers:this._headers}).then((e=>this._checkResponse(e)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"138fe482-aa90-46db-b20b-613bcdba9e47","Content-Type":"application/json"}});u.getAppInfo().then((e=>{let[t,r]=e;t.forEach((e=>{const t=z(e);H.prepend(t)})),l.src=r.avatar,document.querySelector(".profile__name").textContent=r.name,document.querySelector(".profile__description").textContent=r.about})).catch((e=>console.error));const _=document.querySelector(".profile__edit-btn"),m=document.querySelector(".profile__name"),h=document.querySelector(".profile__description"),v=document.querySelector(".profile__add-btn"),f=document.querySelector(".profile__avatar-btn"),y=document.querySelector("#avatar-modal"),b=y.querySelector(".modal__form"),p=y.querySelector(".modal__submit-btn"),S=y.querySelector(".modal__close-btn"),q=y.querySelector("#profile-avatar-input"),k=document.querySelector("#delete-modal"),E=k.querySelector(".modal__form"),g=k.querySelector(".modal__close-btn"),L=k.querySelectorAll(".modal__submit-btn")[1],C=document.querySelector("#edit-profile-modal"),U=C.querySelector(".modal__form"),I=C.querySelector(".modal__close-btn"),$=C.querySelector("#profile-name-input"),x=C.querySelector("#profile-description-input"),A=document.querySelector("#add-card-modal"),D=A.querySelector(".modal__form"),R=A.querySelector(".modal__submit-btn"),B=A.querySelector(".modal__close-btn"),T=A.querySelector("#add-card-name-input"),P=A.querySelector("#add-card-link-input"),w=document.querySelector("#preview-modal"),N=w.querySelector(".modal__image"),O=w.querySelector(".modal__title"),j=w.querySelector(".modal__close-btn"),J=document.querySelector("#card__template"),H=document.querySelector(".cards__list");function z(e){const t=J.content.querySelector(".card").cloneNode(!0),r=t.querySelector(".card__title"),n=t.querySelector(".card__image"),o=t.querySelector(".card__like-btn"),a=t.querySelector(".card__delete-btn");return 1==e.isLiked&&o.classList.add("card__like-btn_liked"),r.textContent=e.name,n.src=e.link,n.alt=e.name,o.addEventListener("click",(t=>function(e,t){const r=e.target.classList.contains("card__like-btn_liked");u.toggleLike(t,r).then((t=>{e.target.classList.toggle("card__like-btn_liked")})).catch((e=>console.log(e)))}(t,e._id))),a.addEventListener("click",(r=>function(e,t){i=e,d=t,M(k)}(t,e._id))),n.addEventListener("click",(()=>{M(w),O.textContent=e.name,N.src=e.link,N.alt=e.name})),t}function M(e){e.classList.add("modal_opened"),e.addEventListener("click",G),document.addEventListener("keydown",K)}function F(e){e.classList.remove("modal_opened"),e.removeEventListener("click",G),document.removeEventListener("keydown",K)}function G(e){e.target.classList.contains("modal")&&F(e.target)}function K(e){"Escape"===e.key&&F(document.querySelector(".modal_opened"))}_.addEventListener("click",(()=>{var e,n;$.value=m.textContent,x.value=h.textContent,e=U,n=t,[$,x].forEach((t=>{r(e,t,n)})),M(C)})),I.addEventListener("click",(()=>{F(C)})),v.addEventListener("click",(()=>{M(A)})),B.addEventListener("click",(()=>{F(A)})),j.addEventListener("click",(()=>{F(w)})),f.addEventListener("click",(()=>{M(y)})),S.addEventListener("click",(()=>{F(y)})),g.addEventListener("click",(()=>{F(k)})),L.addEventListener("click",(()=>{F(k)})),U.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0),u.editUserInfo({name:$.value,about:x.value}).then((e=>{m.textContent=e.name,h.textContent=e.about,F(C)})).catch((e=>console.log(e))).finally((()=>{s(t,!1)}))})),D.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;s(r,!0),u.addCard({name:T.value,link:P.value}).then((r=>{const n=z(r);H.prepend(n),e.target.reset(),o(R,t),F(A)})).catch((e=>console.log(e))).finally((()=>{s(r,!1)}))})),b.addEventListener("submit",(function(e){e.preventDefault();const r=e.submitter;s(r,!0),u.editAvatarInfo(q.value).then((r=>{l.src=r.avatar,e.target.reset(),o(p,t),F(y)})).catch((e=>console.log(e))).finally((()=>{s(r,!1)}))})),E.addEventListener("submit",(function(e){e.preventDefault();const t=e.submitter;s(t,!0,"Delete","Deleting..."),u.deleteCard(d).then((()=>{i.remove(),F(k)})).catch(console.error).finally((()=>{s(t,!1,"Delete","Deleting...")}))})),a(t)}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QjhKLEVBQVdoQyxFQUFVLElBRXRCdkIsT0FBT0MsR0FBUUMsUUFBUTZDLElBQUk5QyxLQUMzQjhELFNBQVEsS0FDUDFILEVBQWN3SCxHQUFXLEVBQU0sR0FFckMsSUEyRkFuRCxFQUFXM0UsaUJBQWlCLFVBeEQ1QixTQUE0QjJHLEdBQzFCQSxFQUFJa0IsaUJBQ0osTUFBTUMsRUFBWW5CLEVBQUlvQixVQUN0QnpILEVBQWN3SCxHQUFXLEdBQ3pCMUcsRUFDRzZCLGVBQWU2QixFQUFZOEMsT0FDM0JwRixNQUFNMkQsSUFDTGxGLEVBQWNGLElBQU1vRixFQUFLakQsT0FDekJ5RCxFQUFJRSxPQUFPcUIsUUFDWGhKLEVBQWMwRixFQUFpQmxILEdBQy9COEosRUFBVzlDLEVBQVksSUFFeEJULE9BQU9DLEdBQVFDLFFBQVE2QyxJQUFJOUMsS0FDM0I4RCxTQUFRLEtBQ1AxSCxFQUFjd0gsR0FBVyxFQUFNLEdBRXJDLElBeUNBOUMsRUFBV2hGLGlCQUFpQixVQTFFNUIsU0FBNEIyRyxHQUMxQkEsRUFBSWtCLGlCQUNKLE1BQU1DLEVBQVluQixFQUFJb0IsVUFDdEJ6SCxFQUFjd0gsR0FBVyxFQUFNLFNBQVUsZUFDekMxRyxFQUNHa0MsV0FBV25DLEdBQ1hxQixNQUFLLEtBRUp0QixFQUFhekMsU0FDYitJLEVBQVd6QyxFQUFZLElBRXhCZCxNQUFNRSxRQUFRQyxPQUNkNEQsU0FBUSxLQUNQMUgsRUFBY3dILEdBQVcsRUFBTyxTQUFVLGNBQWMsR0FFOUQsSUE2REF4SSxFQUFpQjVCLEUiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zZV9wcm9qZWN0X3Nwb3RzL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvd2VicGFjay9ydW50aW1lL3B1YmxpY1BhdGgiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy9zY3JpcHRzL3ZhbGlkYXRpb24uanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9oZWxwZXJzLmpzIiwid2VicGFjazovL3NlX3Byb2plY3Rfc3BvdHMvLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vc2VfcHJvamVjdF9zcG90cy8uL3NyYy91dGlscy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gVGhlIHJlcXVpcmUgc2NvcGVcbnZhciBfX3dlYnBhY2tfcmVxdWlyZV9fID0ge307XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18ucCA9IFwiXCI7IiwiZXhwb3J0IGNvbnN0IHNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX3N1Ym1pdC1idG5cIixcclxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19zdWJtaXQtYnRuX2Rpc2FibGVkXCIsXHJcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXHJcbiAgZXJyb3JDbGFzczogXCJtb2RhbF9fZXJyb3JfdmlzaWJsZVwiLFxyXG59O1xyXG5cclxuY29uc3Qgc2hvd0lucHV0RXJyb3IgPSAoZm9ybUVMLCBpbnB1dEVMLCBlcnJvck1zZywgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FTC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVMLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBlcnJvck1zZztcclxuICBpbnB1dEVMLmNsYXNzTGlzdC5hZGQoY29uZmlnLmlucHV0RXJyb3JDbGFzcyk7XHJcbn07XHJcbmNvbnN0IGhpZGVJbnB1dEVycm9yID0gKGZvcm1FTCwgaW5wdXRFTCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZXJyb3JNc2dFbCA9IGZvcm1FTC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVMLmlkfS1lcnJvcmApO1xyXG4gIGVycm9yTXNnRWwudGV4dENvbnRlbnQgPSBcIlwiO1xyXG4gIGlucHV0RUwuY2xhc3NMaXN0LnJlbW92ZShjb25maWcuaW5wdXRFcnJvckNsYXNzKTtcclxufTtcclxuY29uc3QgY2hlY2tJbnB1dFZhbGlkaXR5ID0gKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKSA9PiB7XHJcbiAgaWYgKCFpbnB1dEVsLnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICBzaG93SW5wdXRFcnJvcihmb3JtRWwsIGlucHV0RWwsIGlucHV0RWwudmFsaWRhdGlvbk1lc3NhZ2UsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXRFbCwgY29uZmlnKTtcclxuICB9XHJcbn07XHJcbmNvbnN0IGhhc0ludmFsaWRJbnB1dCA9IChpbnB1dExpc3QpID0+IHtcclxuICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0KSA9PiB7XHJcbiAgICByZXR1cm4gIWlucHV0LnZhbGlkaXR5LnZhbGlkO1xyXG4gIH0pO1xyXG59O1xyXG5jb25zdCB0b2dnbGVCdXR0b25TdGF0ZSA9IChpbnB1dExpc3QsIGJ1dHRvbkVsLCBjb25maWcpID0+IHtcclxuICBpZiAoaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcclxuICAgIGRpc2FibGVCdXR0b24oYnV0dG9uRWwsIGNvbmZpZyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIGJ1dHRvbkVsLmRpc2FibGVkID0gZmFsc2U7XHJcbiAgICBidXR0b25FbC5jbGFzc0xpc3QucmVtb3ZlKGNvbmZpZy5pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG5leHBvcnQgY29uc3QgZGlzYWJsZUJ1dHRvbiA9IChidXR0b24sIGNvbmZpZykgPT4ge1xyXG4gIGJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XHJcbiAgYnV0dG9uLmNsYXNzTGlzdC5hZGQoY29uZmlnLmluYWN0aXZlQnV0dG9uQ2xhc3MpO1xyXG59O1xyXG5cclxuLy9vcHRpb25hbFxyXG5leHBvcnQgY29uc3QgcmVzZXRWYWxpZGF0aW9uID0gKGZvcm1FbCwgaW5wdXRMaXN0LCBjb25maWcpID0+IHtcclxuICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgIGhpZGVJbnB1dEVycm9yKGZvcm1FbCwgaW5wdXQsIGNvbmZpZyk7XHJcbiAgfSk7XHJcbn07XHJcbmNvbnN0IHNldEV2ZW50TGlzdGVuZXJzID0gKGZvcm1FbCwgY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShmb3JtRWwucXVlcnlTZWxlY3RvckFsbChjb25maWcuaW5wdXRTZWxlY3RvcikpO1xyXG4gIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBmb3JtRWwucXVlcnlTZWxlY3Rvcihjb25maWcuc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xyXG5cclxuICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQsIGNvbmZpZyk7XHJcblxyXG4gIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICBjaGVja0lucHV0VmFsaWRpdHkoZm9ybUVsLCBpbnB1dEVsZW1lbnQsIGNvbmZpZyk7XHJcbiAgICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCwgY29uZmlnKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGVuYWJsZVZhbGlkYXRpb24gPSAoY29uZmlnKSA9PiB7XHJcbiAgY29uc3QgZm9ybUxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpO1xyXG4gIGZvcm1MaXN0LmZvckVhY2goKGZvcm1FbCkgPT4ge1xyXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVsLCBjb25maWcpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImV4cG9ydCBmdW5jdGlvbiBzZXRCdXR0b25UZXh0KFxyXG4gIGJ0bixcclxuICBpc0xvYWRpbmcsXHJcbiAgZGVmYXVsdFRleHQgPSBcIlNhdmVcIixcclxuICBsb2FkaW5nVGV4dCA9IFwiU2F2aW5nLi4uXCJcclxuKSB7XHJcbiAgaWYgKGlzTG9hZGluZykge1xyXG4gICAgLy9zZXQgbG9hZGluZyB0ZXh0XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBsb2FkaW5nVGV4dDtcclxuICB9IGVsc2Uge1xyXG4gICAgLy9zZXQgZGVmYXVsdCB0ZXh0XHJcbiAgICBidG4udGV4dENvbnRlbnQgPSBkZWZhdWx0VGV4dDtcclxuICB9XHJcbn0iLCIvLzEzOGZlNDgyLWFhOTAtNDZkYi1iMjBiLTYxM2JjZGJhOWU0N1xyXG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xyXG5pbXBvcnQge1xyXG4gIGVuYWJsZVZhbGlkYXRpb24sXHJcbiAgc2V0dGluZ3MsXHJcbiAgcmVzZXRWYWxpZGF0aW9uLFxyXG4gIGRpc2FibGVCdXR0b24sXHJcbn0gZnJvbSBcIi4uL3NjcmlwdHMvdmFsaWRhdGlvbi5qc1wiO1xyXG5pbXBvcnQgQXBpIGZyb20gXCIuLi91dGlscy9BcGkuanNcIjtcclxuaW1wb3J0IHsgc2V0QnV0dG9uVGV4dCB9IGZyb20gXCIuLi91dGlscy9oZWxwZXJzLmpzXCI7XHJcblxyXG4vLyBJbXBvcnQgdGhlIGltYWdlXHJcbmltcG9ydCBsb2dvIGZyb20gXCIuLi9pbWFnZXMvbG9nby5zdmdcIjtcclxuaW1wb3J0IGF2YXRhciBmcm9tIFwiLi4vaW1hZ2VzL2F2YXRhci5qcGdcIjtcclxuXHJcbi8vIFNlbGVjdCB0aGUgZWxlbWVudCBhbmQgc2V0IHRoZSBzcmNcclxuY29uc3QgaGVhZGVyTG9nbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaGVhZGVyX19sb2dvXCIpO1xyXG5oZWFkZXJMb2dvLnNyYyA9IGxvZ287XHJcblxyXG5jb25zdCBwcm9maWxlQXZhdGFyID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9maWxlX19hdmF0YXJcIik7XHJcbmxldCBzZWxlY3RlZENhcmQ7XHJcbmxldCBzZWxlY3RlZENhcmRJZDtcclxuXHJcbmNvbnN0IGFwaSA9IG5ldyBBcGkoe1xyXG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcclxuICBoZWFkZXJzOiB7XHJcbiAgICBhdXRob3JpemF0aW9uOiBcIjEzOGZlNDgyLWFhOTAtNDZkYi1iMjBiLTYxM2JjZGJhOWU0N1wiLFxyXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXHJcbiAgfSxcclxufSk7XHJcbi8vZGVzdHJ1Y3R1cmUgdGhlIHNlY29uZCBpdGVtIGluIHRoZSBjYWxsYmFjayBvZiB0aGUgLnRoZW4oKVxyXG5hcGlcclxuICAuZ2V0QXBwSW5mbygpXHJcbiAgLnRoZW4oKFtjYXJkcywgdXNlcnNdKSA9PiB7XHJcbiAgICBjYXJkcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoaXRlbSk7XHJcbiAgICAgIGNhcmRzTGlzdC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcclxuICAgIH0pO1xyXG5cclxuICAgIC8vaGFuZGxlIHRoZSB1c2VycyBpbmZvcm1hdGlvblxyXG4gICAgLy9zZXQgdGhlIHNyYyBvZiBhdmF0YXIgaW1nXHJcbiAgICBwcm9maWxlQXZhdGFyLnNyYyA9IHVzZXJzLmF2YXRhcjtcclxuICAgIC8vc2V0IHRleHRDb250ZW50IG9mIGJvdGggdGhlIHRleHQgZWxlbWVudHNcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKS50ZXh0Q29udGVudCA9IHVzZXJzLm5hbWU7XHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpLnRleHRDb250ZW50ID0gdXNlcnMuYWJvdXQ7XHJcbiAgfSlcclxuICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5lcnJvcik7XHJcblxyXG4vL1Byb2ZpbGUgRWxlbWVudHNcclxuY29uc3QgcHJvZmlsZUVkaXRCdG4gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2VkaXQtYnRuXCIpO1xyXG5jb25zdCBwcm9maWxlTmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fbmFtZVwiKTtcclxuY29uc3QgcHJvZmlsZURlc2NyaXB0aW9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiKTtcclxuY29uc3QgY2FyZE1vZGFsQnRuID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbEJ0biA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fYXZhdGFyLWJ0blwiKTtcclxuXHJcbi8vQXZhdGFyIE1vZGFsXHJcbmNvbnN0IGF2YXRhck1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhdmF0YXItbW9kYWxcIik7XHJcbmNvbnN0IGF2YXRhckZvcm0gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBhdmF0YXJTdWJtaXRCdG4gPSBhdmF0YXJNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJNb2RhbENsb3NlQnRuID0gYXZhdGFyTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBhdmF0YXJJbnB1dCA9IGF2YXRhck1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItaW5wdXRcIik7XHJcblxyXG4vL0RlbGV0ZSBGb3JtIEVsZW1lbnRzXHJcbmNvbnN0IGRlbGV0ZU1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtbW9kYWxcIik7XHJcbmNvbnN0IGRlbGV0ZUZvcm0gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBkZWxldGVNb2RhbENsb3NlQnRuID0gZGVsZXRlTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2UtYnRuXCIpO1xyXG5jb25zdCBkZWxldGVDYW5jZWxCdG4gPSBkZWxldGVNb2RhbC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19zdWJtaXQtYnRuXCIpWzFdO1xyXG5cclxuLy9FZGl0IFByb2ZpbGUgTW9kYWxcclxuY29uc3QgZWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNlZGl0LXByb2ZpbGUtbW9kYWxcIik7XHJcbmNvbnN0IGVkaXRGb3JtRWxlbWVudCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBlZGl0TW9kYWxDbG9zZUJ0biA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZS1idG5cIik7XHJcbmNvbnN0IGVkaXRNb2RhbE5hbWVJbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtbmFtZS1pbnB1dFwiKTtcclxuY29uc3QgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dCA9IGVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxyXG4pO1xyXG5cclxuLy9BZGQgQ2FyZCBNb2RhbFxyXG5jb25zdCBjYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW1vZGFsXCIpO1xyXG5jb25zdCBjYXJkRm9ybSA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xyXG5jb25zdCBjYXJkU3VibWl0QnRuID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3N1Ym1pdC1idG5cIik7XHJcbmNvbnN0IGNhcmRNb2RhbENsb3NlQnRuID0gY2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuY29uc3QgY2FyZE5hbWVJbnB1dCA9IGNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLW5hbWUtaW5wdXRcIik7XHJcbmNvbnN0IGNhcmRMaW5rSW5wdXQgPSBjYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1saW5rLWlucHV0XCIpO1xyXG5cclxuLy9QcmV2aWV3IENhcmQgTW9kYWxcclxuY29uc3QgcHJldmlld01vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcmV2aWV3LW1vZGFsXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxJbWFnZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxUaXRsZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX3RpdGxlXCIpO1xyXG5jb25zdCBwcmV2aWV3TW9kYWxDbG9zZUVsID0gcHJldmlld01vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlLWJ0blwiKTtcclxuXHJcbmNvbnN0IGNhcmRUZW1wbGF0ZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjY2FyZF9fdGVtcGxhdGVcIik7XHJcbmNvbnN0IGNhcmRzTGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XHJcblxyXG5mdW5jdGlvbiBnZXRDYXJkRWxlbWVudChkYXRhKSB7XHJcbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkVGVtcGxhdGUuY29udGVudFxyXG4gICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxyXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcclxuXHJcbiAgY29uc3QgY2FyZE5hbWVFbCA9IGNhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XHJcbiAgY29uc3QgY2FyZEltYWdlRWwgPSBjYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xyXG4gIGNvbnN0IGNhcmRMaWtlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19saWtlLWJ0blwiKTtcclxuICBjb25zdCBjYXJkRGVsZXRlQnRuID0gY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnRuXCIpO1xyXG5cclxuICBpZiAoZGF0YS5pc0xpa2VkID09IHRydWUpIHtcclxuICAgIGNhcmRMaWtlQnRuLmNsYXNzTGlzdC5hZGQoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuICB9XHJcblxyXG4gIGNhcmROYW1lRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgY2FyZEltYWdlRWwuc3JjID0gZGF0YS5saW5rO1xyXG4gIGNhcmRJbWFnZUVsLmFsdCA9IGRhdGEubmFtZTtcclxuXHJcbiAgY2FyZExpa2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+IGhhbmRsZUxpa2UoZXZ0LCBkYXRhLl9pZCkpO1xyXG4gIGNhcmREZWxldGVCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldnQpID0+XHJcbiAgICBoYW5kbGVEZWxldGVDYXJkKGNhcmRFbGVtZW50LCBkYXRhLl9pZClcclxuICApO1xyXG4gIGNhcmRJbWFnZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICBvcGVuTW9kYWwocHJldmlld01vZGFsKTtcclxuICAgIHByZXZpZXdNb2RhbFRpdGxlRWwudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICBwcmV2aWV3TW9kYWxJbWFnZUVsLnNyYyA9IGRhdGEubGluaztcclxuICAgIHByZXZpZXdNb2RhbEltYWdlRWwuYWx0ID0gZGF0YS5uYW1lO1xyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gY2FyZEVsZW1lbnQ7XHJcbn1cclxuZnVuY3Rpb24gb3Blbk1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VNb2RhbEJ5T3ZlcmxheSk7XHJcbiAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbEJ5RXNjKTtcclxufVxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsKG1vZGFsKSB7XHJcbiAgbW9kYWwuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcclxuICBtb2RhbC5yZW1vdmVFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgY2xvc2VNb2RhbEJ5T3ZlcmxheSk7XHJcbiAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgY2xvc2VNb2RhbEJ5RXNjKTtcclxufVxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsQnlPdmVybGF5KGV2dCkge1xyXG4gIGlmIChldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpKSB7XHJcbiAgICBjbG9zZU1vZGFsKGV2dC50YXJnZXQpO1xyXG4gIH1cclxufVxyXG5mdW5jdGlvbiBjbG9zZU1vZGFsQnlFc2MoZXZ0KSB7XHJcbiAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgIGNvbnN0IG1vZGFsT3BlbmVkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XHJcbiAgICBjbG9zZU1vZGFsKG1vZGFsT3BlbmVkKTtcclxuICB9XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlRWRpdEZvcm1TdWJtaXQoZXZ0KSB7XHJcbiAgLy8gUHJldmVudCBkZWZhdWx0IGJyb3dzZXIgYmVoYXZpb3JcclxuICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAvL2NoYW5nZSB0ZXh0IGNvbnRlbnQgdG8gc2F2aW5nLi4uXHJcbiAgY29uc3Qgc3VibWl0QnRuID0gZXZ0LnN1Ym1pdHRlcjtcclxuICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgdHJ1ZSk7XHJcblxyXG4gIGFwaVxyXG4gICAgLmVkaXRVc2VySW5mbyh7XHJcbiAgICAgIG5hbWU6IGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSxcclxuICAgICAgYWJvdXQ6IGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUsXHJcbiAgICB9KVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZU5hbWUudGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XHJcbiAgICAgIHByb2ZpbGVEZXNjcmlwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEuYWJvdXQ7XHJcbiAgICAgIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgLy9jaGFuZ2UgdGV4dCBjb250ZW50IGJhY2sgdG8gc2F2ZVxyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuXHJcbi8vVE9ETyBpbXBsZW1lbnQgbG9hZGluZyB0ZXh0IGZvciBhbGwgb3RoZXIgZm9ybSBzdWJtaXNzaW9uc1xyXG5mdW5jdGlvbiBoYW5kbGVBZGRDYXJkU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmFkZENhcmQoeyBuYW1lOiBjYXJkTmFtZUlucHV0LnZhbHVlLCBsaW5rOiBjYXJkTGlua0lucHV0LnZhbHVlIH0pXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBjb25zdCBjYXJkRWwgPSBnZXRDYXJkRWxlbWVudChkYXRhKTtcclxuICAgICAgLy9wcmVwZW5kIG9yIGFwcGVuZD8gUGVyc29uYWxseSBpIGxpa2UgYXBwZW5kIGJ1dCBJJ2xsIGtlZXAgYXMgaXNcclxuICAgICAgY2FyZHNMaXN0LnByZXBlbmQoY2FyZEVsKTtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGNhcmRTdWJtaXRCdG4sIHNldHRpbmdzKTtcclxuICAgICAgY2xvc2VNb2RhbChjYXJkTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaCgoZXJyKSA9PiBjb25zb2xlLmxvZyhlcnIpKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UpO1xyXG4gICAgfSk7XHJcbn1cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZChjYXJkRWxlbWVudCwgY2FyZElkKSB7XHJcbiAgc2VsZWN0ZWRDYXJkID0gY2FyZEVsZW1lbnQ7XHJcbiAgc2VsZWN0ZWRDYXJkSWQgPSBjYXJkSWQ7XHJcbiAgb3Blbk1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufVxyXG5mdW5jdGlvbiBoYW5kbGVMaWtlKGV2dCwgY2FyZElkKSB7XHJcbiAgY29uc3QgaXNMaWtlZCA9IGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwiY2FyZF9fbGlrZS1idG5fbGlrZWRcIik7XHJcbiAgYXBpXHJcbiAgICAudG9nZ2xlTGlrZShjYXJkSWQsIGlzTGlrZWQpXHJcbiAgICAudGhlbigoZGF0YSkgPT4ge1xyXG4gICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoXCJjYXJkX19saWtlLWJ0bl9saWtlZFwiKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSk7XHJcbn1cclxuXHJcbi8vIFRoZSBzdWJtaXNzaW9uIGhhbmRsZXIgbWFrZXMgdXNlIG9mIHRoZSBzZWxlY3RlZENhcmQgYW5kIHNlbGVjdGVkQ2FyZElkXHJcbi8vIHZhcmlhYmxlcyB0byB0YXJnZXQgdGhlIGNvcnJlY3QgY2FyZC5cclxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgYXBpXHJcbiAgICAuZGVsZXRlQ2FyZChzZWxlY3RlZENhcmRJZCkgLy8gcGFzcyB0aGUgSUQgdGhlIHRoZSBhcGkgZnVuY3Rpb25cclxuICAgIC50aGVuKCgpID0+IHtcclxuICAgICAgLy8gcmVtb3ZlIHRoZSBjYXJkIGZyb20gdGhlIERPTSBhbmQgdGhlbiBjbG9zZSBtb2RhbFxyXG4gICAgICBzZWxlY3RlZENhcmQucmVtb3ZlKCk7XHJcbiAgICAgIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG4gICAgfSlcclxuICAgIC5jYXRjaChjb25zb2xlLmVycm9yKVxyXG4gICAgLmZpbmFsbHkoKCkgPT4ge1xyXG4gICAgICBzZXRCdXR0b25UZXh0KHN1Ym1pdEJ0biwgZmFsc2UsIFwiRGVsZXRlXCIsIFwiRGVsZXRpbmcuLi5cIik7XHJcbiAgICB9KTtcclxufVxyXG5cclxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyU3VibWl0KGV2dCkge1xyXG4gIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIGNvbnN0IHN1Ym1pdEJ0biA9IGV2dC5zdWJtaXR0ZXI7XHJcbiAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIHRydWUpO1xyXG4gIGFwaVxyXG4gICAgLmVkaXRBdmF0YXJJbmZvKGF2YXRhcklucHV0LnZhbHVlKVxyXG4gICAgLnRoZW4oKGRhdGEpID0+IHtcclxuICAgICAgcHJvZmlsZUF2YXRhci5zcmMgPSBkYXRhLmF2YXRhcjtcclxuICAgICAgZXZ0LnRhcmdldC5yZXNldCgpO1xyXG4gICAgICBkaXNhYmxlQnV0dG9uKGF2YXRhclN1Ym1pdEJ0biwgc2V0dGluZ3MpO1xyXG4gICAgICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxuICAgIH0pXHJcbiAgICAuY2F0Y2goKGVycikgPT4gY29uc29sZS5sb2coZXJyKSlcclxuICAgIC5maW5hbGx5KCgpID0+IHtcclxuICAgICAgc2V0QnV0dG9uVGV4dChzdWJtaXRCdG4sIGZhbHNlKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5wcm9maWxlRWRpdEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGVkaXRNb2RhbE5hbWVJbnB1dC52YWx1ZSA9IHByb2ZpbGVOYW1lLnRleHRDb250ZW50O1xyXG4gIGVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQudmFsdWUgPSBwcm9maWxlRGVzY3JpcHRpb24udGV4dENvbnRlbnQ7XHJcbiAgcmVzZXRWYWxpZGF0aW9uKFxyXG4gICAgZWRpdEZvcm1FbGVtZW50LFxyXG4gICAgW2VkaXRNb2RhbE5hbWVJbnB1dCwgZWRpdE1vZGFsRGVzY3JpcHRpb25JbnB1dF0sXHJcbiAgICBzZXR0aW5nc1xyXG4gICk7XHJcbiAgb3Blbk1vZGFsKGVkaXRNb2RhbCk7XHJcbn0pO1xyXG5lZGl0TW9kYWxDbG9zZUJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZWRpdE1vZGFsKTtcclxufSk7XHJcbmNhcmRNb2RhbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIG9wZW5Nb2RhbChjYXJkTW9kYWwpO1xyXG59KTtcclxuY2FyZE1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGNhcmRNb2RhbCk7XHJcbn0pO1xyXG5wcmV2aWV3TW9kYWxDbG9zZUVsLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgY2xvc2VNb2RhbChwcmV2aWV3TW9kYWwpO1xyXG59KTtcclxuXHJcbmF2YXRhck1vZGFsQnRuLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgb3Blbk1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcbmF2YXRhck1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGF2YXRhck1vZGFsKTtcclxufSk7XHJcbmRlbGV0ZU1vZGFsQ2xvc2VCdG4uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICBjbG9zZU1vZGFsKGRlbGV0ZU1vZGFsKTtcclxufSk7XHJcbmRlbGV0ZUNhbmNlbEJ0bi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIGNsb3NlTW9kYWwoZGVsZXRlTW9kYWwpO1xyXG59KTtcclxuXHJcbmVkaXRGb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUVkaXRGb3JtU3VibWl0KTtcclxuY2FyZEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVBZGRDYXJkU3VibWl0KTtcclxuYXZhdGFyRm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIGhhbmRsZUF2YXRhclN1Ym1pdCk7XHJcbmRlbGV0ZUZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBoYW5kbGVEZWxldGVTdWJtaXQpO1xyXG5cclxuZW5hYmxlVmFsaWRhdGlvbihzZXR0aW5ncyk7XHJcbiIsImNsYXNzIEFwaSB7XHJcbiAgY29uc3RydWN0b3IoeyBiYXNlVXJsLCBoZWFkZXJzIH0pIHtcclxuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcclxuICAgIHRoaXMuX2Jhc2VVcmwgPSBiYXNlVXJsO1xyXG4gICAgdGhpcy5faGVhZGVycyA9IGhlYWRlcnM7XHJcblxyXG4gICAgdGhpcy5fY2hlY2tSZXNwb25zZSA9IChyZXMpID0+IHtcclxuICAgICAgaWYgKHJlcy5vaykge1xyXG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xyXG4gICAgICB9XHJcbiAgICAgIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldEFwcEluZm8oKSB7XHJcbiAgICByZXR1cm4gUHJvbWlzZS5hbGwoW3RoaXMuZ2V0SW5pdGlhbENhcmRzKCksIHRoaXMuZ2V0VXNlckluZm8oKV0pO1xyXG4gIH1cclxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHNgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG4gIC8vIG90aGVyIG1ldGhvZHMgZm9yIHdvcmtpbmcgd2l0aCB0aGUgQVBJXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vdXNlcnMvbWVgLCB7XHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG4gIC8vIFBhc3MgdGhlIGRhdGEgYXMgYW4gYXJndW1lbnQuIEluIHRoaXMgZXhhbXBsZSwgd2UgYXJlIHVzaW5nIGRlc3RydWN0dXJpbmcsXHJcbiAgLy8gc28gd2Ugd291bGQgbmVlZCB0byBwYXNzIHRoZSBmdW5jdGlvbiBhbiBvYmplY3Qgd2l0aCBwcm9wZXJ0aWVzIGNhbGxlZFxyXG4gIC8vIG5hbWUgYW5kIGFib3V0LlxyXG4gIGVkaXRVc2VySW5mbyh7IG5hbWUsIGFib3V0IH0pIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZWAsIHtcclxuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXHJcbiAgICAgIGhlYWRlcnM6IHRoaXMuX2hlYWRlcnMsXHJcbiAgICAgIC8vIFNlbmQgdGhlIGRhdGEgaW4gdGhlIGJvZHkgYXMgYSBKU09OIHN0cmluZy5cclxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xyXG4gICAgICAgIG5hbWUsXHJcbiAgICAgICAgYWJvdXQsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuICBlZGl0QXZhdGFySW5mbyhhdmF0YXIpIHtcclxuICAgIHJldHVybiBmZXRjaChgJHt0aGlzLl9iYXNlVXJsfS91c2Vycy9tZS9hdmF0YXJgLCB7XHJcbiAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBhdmF0YXIsXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuICAvL0ltcGxlbWVudCBQT1NUL2NhcmRzXHJcbiAgYWRkQ2FyZCh7IG5hbWUsIGxpbmsgfSkge1xyXG4gICAgcmV0dXJuIGZldGNoKGAke3RoaXMuX2Jhc2VVcmx9L2NhcmRzYCwge1xyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBuYW1lLFxyXG4gICAgICAgIGxpbmssXHJcbiAgICAgIH0pLFxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuICBkZWxldGVDYXJkKGlkKSB7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH1gLCB7XHJcbiAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgaGVhZGVyczogdGhpcy5faGVhZGVycyxcclxuICAgICAgLy8gU2VuZCB0aGUgZGF0YSBpbiB0aGUgYm9keSBhcyBhIEpTT04gc3RyaW5nLlxyXG4gICAgfSkudGhlbigocmVzKSA9PiB0aGlzLl9jaGVja1Jlc3BvbnNlKHJlcykpO1xyXG4gIH1cclxuICB0b2dnbGVMaWtlKGlkLCBpc0xpa2VkKSB7XHJcbiAgICBjb25zdCBtZXRob2QgPSBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCI7XHJcbiAgICByZXR1cm4gZmV0Y2goYCR7dGhpcy5fYmFzZVVybH0vY2FyZHMvJHtpZH0vbGlrZXNgLCB7XHJcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxyXG4gICAgICBoZWFkZXJzOiB0aGlzLl9oZWFkZXJzLFxyXG4gICAgICAvLyBTZW5kIHRoZSBkYXRhIGluIHRoZSBib2R5IGFzIGEgSlNPTiBzdHJpbmcuXHJcbiAgICB9KS50aGVuKChyZXMpID0+IHRoaXMuX2NoZWNrUmVzcG9uc2UocmVzKSk7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBleHBvcnQgdGhlIGNsYXNzXHJcbmV4cG9ydCBkZWZhdWx0IEFwaTtcclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJzZXR0aW5ncyIsImZvcm1TZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiaGlkZUlucHV0RXJyb3IiLCJmb3JtRUwiLCJpbnB1dEVMIiwiY29uZmlnIiwicXVlcnlTZWxlY3RvciIsImlkIiwidGV4dENvbnRlbnQiLCJjbGFzc0xpc3QiLCJyZW1vdmUiLCJ0b2dnbGVCdXR0b25TdGF0ZSIsImlucHV0TGlzdCIsImJ1dHRvbkVsIiwic29tZSIsImlucHV0IiwidmFsaWRpdHkiLCJ2YWxpZCIsImhhc0ludmFsaWRJbnB1dCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImJ1dHRvbiIsImFkZCIsImVuYWJsZVZhbGlkYXRpb24iLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiZm9ybUVsIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJBcnJheSIsImZyb20iLCJidXR0b25FbGVtZW50IiwiaW5wdXRFbGVtZW50IiwiYWRkRXZlbnRMaXN0ZW5lciIsImNoZWNrSW5wdXRWYWxpZGl0eSIsImlucHV0RWwiLCJzaG93SW5wdXRFcnJvciIsImVycm9yTXNnIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJzZXRCdXR0b25UZXh0IiwiYnRuIiwiaXNMb2FkaW5nIiwiZGVmYXVsdFRleHQiLCJhcmd1bWVudHMiLCJsZW5ndGgiLCJ1bmRlZmluZWQiLCJsb2FkaW5nVGV4dCIsImdldEVsZW1lbnRCeUlkIiwic3JjIiwibG9nbyIsInByb2ZpbGVBdmF0YXIiLCJzZWxlY3RlZENhcmQiLCJzZWxlY3RlZENhcmRJZCIsImFwaSIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImJhc2VVcmwiLCJoZWFkZXJzIiwidGhpcyIsIl9iYXNlVXJsIiwiX2hlYWRlcnMiLCJfY2hlY2tSZXNwb25zZSIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJnZXRBcHBJbmZvIiwiYWxsIiwiZ2V0SW5pdGlhbENhcmRzIiwiZ2V0VXNlckluZm8iLCJmZXRjaCIsInRoZW4iLCJlZGl0VXNlckluZm8iLCJfcmVmMiIsIm5hbWUiLCJhYm91dCIsIm1ldGhvZCIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiZWRpdEF2YXRhckluZm8iLCJhdmF0YXIiLCJhZGRDYXJkIiwiX3JlZjMiLCJsaW5rIiwiZGVsZXRlQ2FyZCIsInRvZ2dsZUxpa2UiLCJpc0xpa2VkIiwiYXV0aG9yaXphdGlvbiIsImNhcmRzIiwidXNlcnMiLCJpdGVtIiwiY2FyZEVsZW1lbnQiLCJnZXRDYXJkRWxlbWVudCIsImNhcmRzTGlzdCIsInByZXBlbmQiLCJjYXRjaCIsImVyciIsImNvbnNvbGUiLCJlcnJvciIsInByb2ZpbGVFZGl0QnRuIiwicHJvZmlsZU5hbWUiLCJwcm9maWxlRGVzY3JpcHRpb24iLCJjYXJkTW9kYWxCdG4iLCJhdmF0YXJNb2RhbEJ0biIsImF2YXRhck1vZGFsIiwiYXZhdGFyRm9ybSIsImF2YXRhclN1Ym1pdEJ0biIsImF2YXRhck1vZGFsQ2xvc2VCdG4iLCJhdmF0YXJJbnB1dCIsImRlbGV0ZU1vZGFsIiwiZGVsZXRlRm9ybSIsImRlbGV0ZU1vZGFsQ2xvc2VCdG4iLCJkZWxldGVDYW5jZWxCdG4iLCJlZGl0TW9kYWwiLCJlZGl0Rm9ybUVsZW1lbnQiLCJlZGl0TW9kYWxDbG9zZUJ0biIsImVkaXRNb2RhbE5hbWVJbnB1dCIsImVkaXRNb2RhbERlc2NyaXB0aW9uSW5wdXQiLCJjYXJkTW9kYWwiLCJjYXJkRm9ybSIsImNhcmRTdWJtaXRCdG4iLCJjYXJkTW9kYWxDbG9zZUJ0biIsImNhcmROYW1lSW5wdXQiLCJjYXJkTGlua0lucHV0IiwicHJldmlld01vZGFsIiwicHJldmlld01vZGFsSW1hZ2VFbCIsInByZXZpZXdNb2RhbFRpdGxlRWwiLCJwcmV2aWV3TW9kYWxDbG9zZUVsIiwiY2FyZFRlbXBsYXRlIiwiZGF0YSIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJjYXJkTmFtZUVsIiwiY2FyZEltYWdlRWwiLCJjYXJkTGlrZUJ0biIsImNhcmREZWxldGVCdG4iLCJhbHQiLCJldnQiLCJjYXJkSWQiLCJ0YXJnZXQiLCJjb250YWlucyIsInRvZ2dsZSIsImxvZyIsImhhbmRsZUxpa2UiLCJfaWQiLCJvcGVuTW9kYWwiLCJoYW5kbGVEZWxldGVDYXJkIiwibW9kYWwiLCJjbG9zZU1vZGFsQnlPdmVybGF5IiwiY2xvc2VNb2RhbEJ5RXNjIiwiY2xvc2VNb2RhbCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJrZXkiLCJyZXNldFZhbGlkYXRpb24iLCJ2YWx1ZSIsInByZXZlbnREZWZhdWx0Iiwic3VibWl0QnRuIiwic3VibWl0dGVyIiwiZmluYWxseSIsImNhcmRFbCIsInJlc2V0Il0sInNvdXJjZVJvb3QiOiIifQ==